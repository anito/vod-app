<script>
  import { stores } from '@sapper/app';
  import { Media } from '@smui/card';
  import { getExt, getMedia } from 'utils';

  const posterUrl = `https://via.placeholder.com/320x180.png?text=`;

  export let media = {};

  let { session } = stores();
  let poster = (media && `${posterUrl}${getExt(media.src)}`) || posterUrl;

  async function getPosterUrl(id) {
    if (!id) return false;
    let res = await getMedia('IMAGE', id, $session.user, {
      width: 300,
      height: 300,
      square: 0,
    });
    if (res) poster = res;
  }

  media && getPosterUrl(media.id);
</script>

<Media aspectRatio="16x9" style="background-image:url({poster})" />

<style>
</style>
