<script context="module">
  let players = new Set();
</script>

<script>
  import Video from "./Video.svelte";
  import { onMount } from "svelte";

  export let poster = "";
  export let src = "";
  export let type;
  export let paused = true;

  let video;
  let controls = false; // if false use customControls
  let muted = false;
  let preload = "none";
  let autoplay = false;
  let className = "";

  export { className as class };

  onMount((_) => {
    players.add(video);
  });

  $: ((playing) => {
    playing && pausePlayers();
  })(!paused);

  function pausePlayers() {
    players.forEach((player) => {
        player !== video &&
          ((player.promise && player.promise.then(() => player.pause())) ||
            player.pause());
      });
  }
</script>

<style>
</style>

<Video
  class={className}
  bind:paused
  bind:video
  {poster}
  {preload}
  {muted}
  {src}
  {type}
  {controls}
  {autoplay} />
