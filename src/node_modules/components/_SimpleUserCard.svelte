<script>
  import './meta.scss';
  import { warnings } from '../../stores/warningStore';
  import UserGraphic from './_UserGraphic.svelte';
  import Circle from './_Circle.svelte';
  import { Item, Meta, Separator, Subheader, Text, PrimaryText, SecondaryText, Graphic } from '@smui/list';

  export let selectionUserId = null;
  export let user;
  export { className as class };

  let className = '';

  $: _warnings = ($warnings.has(user.id) && $warnings.get(user.id).warnings) || [];
</script>

<Item class={className} selected={selectionUserId == user.id}>
  <UserGraphic width="40" height="40" {user} border />
  <Text>
    <PrimaryText>{user.name}</PrimaryText>
    <SecondaryText>{user.email}</SecondaryText>
  </Text>
  {#if user.protected}
    <Meta class="material-icons" title="User is readonly">lock</Meta>
  {/if}
  <div class="warnings">
    {#each _warnings as _warn}
      <Circle size="5" />
    {/each}
  </div>
</Item>

<style>
  .warnings {
    margin-left: auto;
    margin-right: 0;
  }
</style>
